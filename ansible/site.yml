---
# This playbook deploys the whole application stack in this site.  

#- name: Update /etc/hosts on control machine
#  hosts: localhost
#  remote_user: "{{ remote_user }}"
#  tags: 'etc-hosts'
#  roles:
#    - etc-hosts
#  environment: "{{ env_os }}"

- name: Install consul server
  remote_user: "{{ remote_user }}"
  hosts: consul
  tags: consul
  roles:
    - consul-agent

- name: Install consul agent on elasticsearch hosts
  remote_user: "{{ remote_user }}"
  hosts: elasticsearch
  tags: consul
  roles:
    - consul-agent

- name: Elasticsearch Nodes
  hosts: elasticsearch
  become: true
  tags: elastic

  roles:
    - elastic
